
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>New Tab</title>
<link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@300;400;500&family=Figtree:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --bg: #2c1f2e;
  --surface: rgba(255,255,255,0.07);
  --border: rgba(255,255,255,0.1);
  --text: #f0e8f0;
  --muted: rgba(240,232,240,0.5);
  --accent: #e8d5f5;
  --card-bg: rgba(255,255,255,0.95);
}

body {
  font-family: 'Figtree', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow: hidden;
  position: relative;
}

/* ‚îÄ‚îÄ BACKGROUND ‚îÄ‚îÄ */
.bg-canvas {
  position: fixed; inset: 0; z-index: 0;
  background: radial-gradient(ellipse 80% 100% at 100% 60%, #5a2060 0%, #3a1545 30%, #2c1f2e 60%, #1a1020 100%);
}
.globe {
  position: fixed; right: -8vw; bottom: -15vh;
  width: 55vw; height: 55vw; border-radius: 50%;
  background: radial-gradient(ellipse at 35% 35%, #7a3a8a 0%, #4a1a5a 30%, #2a0a35 60%, #150820 100%);
  box-shadow: inset -20px -20px 60px rgba(0,0,0,0.6), inset 10px 10px 40px rgba(180,100,220,0.15), 0 0 120px rgba(100,30,130,0.3);
  z-index: 0; overflow: hidden;
}
.globe::after {
  content: ''; position: absolute; inset: 0; border-radius: 50%;
  background-image:
    repeating-linear-gradient(0deg, rgba(255,255,255,0.025) 0px, transparent 1px, transparent 40px, rgba(255,255,255,0.025) 41px),
    repeating-linear-gradient(90deg, rgba(255,255,255,0.025) 0px, transparent 1px, transparent 40px, rgba(255,255,255,0.025) 41px);
}
.grain {
  position: fixed; inset: 0; z-index: 1; pointer-events: none; opacity: 0.35;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.05'/%3E%3C/svg%3E");
}

/* ‚îÄ‚îÄ THEMES ‚îÄ‚îÄ */
[data-theme="midnight"] .bg-canvas { background: radial-gradient(ellipse 80% 100% at 100% 60%, #1a1a4a 0%, #0d0d2a 40%, #05050f 100%); }
[data-theme="midnight"] .globe { background: radial-gradient(ellipse at 35% 35%, #2a2a7a 0%, #15154a 35%, #080820 100%); }
[data-theme="forest"] .bg-canvas { background: radial-gradient(ellipse 80% 100% at 100% 60%, #1a4a20 0%, #0d2a12 40%, #050f07 100%); }
[data-theme="forest"] .globe { background: radial-gradient(ellipse at 35% 35%, #2a7a3a 0%, #154a1e 35%, #082010 100%); }
[data-theme="dusk"] .bg-canvas { background: radial-gradient(ellipse 80% 100% at 100% 60%, #6a2020 0%, #3a1010 40%, #150505 100%); }
[data-theme="dusk"] .globe { background: radial-gradient(ellipse at 35% 35%, #8a3030 0%, #5a1818 35%, #200808 100%); }
[data-theme="ocean"] .bg-canvas { background: radial-gradient(ellipse 80% 100% at 100% 60%, #0a3a6a 0%, #051a3a 40%, #020810 100%); }
[data-theme="ocean"] .globe { background: radial-gradient(ellipse at 35% 35%, #1a5a8a 0%, #0a2a5a 35%, #041020 100%); }

/* ‚îÄ‚îÄ CLOCK ‚îÄ‚îÄ */
.clock-display {
  position: fixed; top: 22px; left: 36px; z-index: 10;
  font-family: 'Fraunces', serif; font-size: 16px; font-weight: 300;
  color: rgba(240,232,240,0.6); letter-spacing: 0.5px;
}

/* ‚îÄ‚îÄ TOP RIGHT ‚îÄ‚îÄ */
.top-right { position: fixed; top: 16px; right: 24px; z-index: 10; display: flex; gap: 8px; }
.ctrl-btn {
  width: 34px; height: 34px; border-radius: 9px;
  background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.1);
  color: rgba(255,255,255,0.55); cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: all 0.15s; backdrop-filter: blur(10px);
}
.ctrl-btn:hover { background: rgba(255,255,255,0.14); color: white; }
.ctrl-btn.active { background: rgba(200,150,255,0.2); border-color: rgba(200,150,255,0.4); color: #e0c8ff; }

/* ‚îÄ‚îÄ PAGE ‚îÄ‚îÄ */
.page { position: relative; z-index: 2; padding: 56px 72px 40px; max-width: 900px; }

/* ‚îÄ‚îÄ GREETING ‚îÄ‚îÄ */
.greeting {
  font-family: 'Fraunces', serif; font-size: 24px; font-weight: 400;
  color: var(--text); margin-bottom: 22px; letter-spacing: -0.2px;
  opacity: 0; animation: fadeUp 0.5s ease 0.05s forwards;
}

/* ‚îÄ‚îÄ SEARCH ‚îÄ‚îÄ */
.search-wrap { margin-bottom: 22px; opacity: 0; animation: fadeUp 0.5s ease 0.15s forwards; }
.search-bar {
  display: flex; align-items: center; gap: 12px;
  background: rgba(255,255,255,0.96); border-radius: 12px; padding: 12px 16px;
  width: 100%; box-shadow: 0 4px 40px rgba(0,0,0,0.3); transition: box-shadow 0.2s;
}
.search-bar:focus-within { box-shadow: 0 4px 50px rgba(0,0,0,0.35), 0 0 0 2px rgba(180,120,255,0.5); }
.search-icon { color: #999; flex-shrink: 0; }
.search-bar input { flex: 1; border: none; outline: none; background: none; font-family: 'Figtree', sans-serif; font-size: 15px; color: #1a1a2e; }
.search-bar input::placeholder { color: #aaa; }
.engine-pill {
  width: 26px; height: 26px; border-radius: 50%; flex-shrink: 0;
  display: flex; align-items: center; justify-content: center;
  font-size: 12px; font-weight: 700; color: white;
  background: linear-gradient(135deg, #4285f4, #ea4335 50%, #34a853); cursor: pointer;
}

/* ‚îÄ‚îÄ TABS ‚îÄ‚îÄ */
.tabs { display: flex; gap: 2px; align-items: center; margin-bottom: 22px; opacity: 0; animation: fadeUp 0.5s ease 0.25s forwards; }
.tab {
  padding: 5px 14px; border-radius: 7px; font-size: 13.5px; font-weight: 500;
  cursor: grab; transition: all 0.15s; color: var(--muted); background: none; border: none;
  font-family: 'Figtree', sans-serif; position: relative; user-select: none;
}
.tab:hover { color: var(--text); background: rgba(255,255,255,0.07); }
.tab.active { color: var(--text); background: rgba(255,255,255,0.07); }
.tab.active::after {
  content: ''; position: absolute; bottom: -3px; left: 50%; transform: translateX(-50%);
  width: 18px; height: 2px; border-radius: 2px; background: rgba(220,200,255,0.7);
}
.tab.drag-over { outline: 2px dashed rgba(200,150,255,0.5); border-radius: 7px; }
.tab.dragging { opacity: 0.4; cursor: grabbing; }
.tab-add-btn {
  width: 28px; height: 28px; border-radius: 7px;
  border: 1.5px dashed rgba(255,255,255,0.2);
  background: none; color: var(--muted); cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  font-size: 16px; transition: all 0.15s; margin-left: 6px;
}
.tab-add-btn:hover { border-color: rgba(255,255,255,0.45); color: var(--text); }

/* ‚îÄ‚îÄ APP GRID ‚îÄ‚îÄ */
.app-grid { display: flex; flex-wrap: wrap; gap: 14px; opacity: 0; animation: fadeUp 0.5s ease 0.35s forwards; }
.app-card {
  display: flex; flex-direction: column; align-items: center; gap: 7px;
  cursor: grab; text-decoration: none; color: inherit;
  animation: popIn 0.25s ease both; user-select: none;
}
.app-card.dragging { opacity: 0.35; cursor: grabbing; }
.app-card.drag-over-card .app-icon { outline: 2px dashed rgba(200,150,255,0.6); }
.app-icon {
  width: 70px; height: 70px; border-radius: 17px; background: var(--card-bg);
  display: flex; align-items: center; justify-content: center; font-size: 30px;
  box-shadow: 0 2px 18px rgba(0,0,0,0.2), 0 1px 0 rgba(255,255,255,0.8) inset;
  transition: all 0.22s cubic-bezier(0.34, 1.56, 0.64, 1); position: relative; overflow: hidden;
}
.app-icon:hover { transform: translateY(-4px) scale(1.06); box-shadow: 0 14px 40px rgba(0,0,0,0.3), 0 1px 0 rgba(255,255,255,0.8) inset; }
.app-name { font-size: 11.5px; font-weight: 400; text-align: center; max-width: 70px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; color: rgba(240,232,240,0.85); }

/* delete overlay in edit mode */
body.edit-mode .app-card:not(.add-app-card) .app-icon::after {
  content: '‚úï'; position: absolute; inset: 0; border-radius: 17px;
  background: rgba(200,20,60,0.88); color: white; font-size: 20px;
  display: flex; align-items: center; justify-content: center;
  opacity: 0; transition: opacity 0.15s;
}
body.edit-mode .app-card:not(.add-app-card):hover .app-icon::after { opacity: 1; }
body.edit-mode .app-card:not(.add-app-card) { cursor: pointer; }

.add-app-card .app-icon {
  background: rgba(255,255,255,0.06); border: 1.5px dashed rgba(255,255,255,0.2);
  box-shadow: none; font-size: 22px; color: var(--muted);
}
.add-app-card:hover .app-icon { background: rgba(255,255,255,0.1); border-color: rgba(255,255,255,0.4); color: var(--text); transform: translateY(-2px); }
.add-app-card .app-name { color: var(--muted); }

/* ‚îÄ‚îÄ SETTINGS PANEL ‚îÄ‚îÄ */
.settings-panel {
  position: fixed; right: 0; top: 0; bottom: 0; width: 270px; z-index: 100;
  background: rgba(25,12,32,0.97); backdrop-filter: blur(20px);
  border-left: 1px solid rgba(255,255,255,0.07);
  padding: 0; display: flex; flex-direction: column;
  transform: translateX(100%); transition: transform 0.3s ease; overflow: hidden;
}
.settings-panel.open { transform: translateX(0); }

.settings-header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 22px 20px 16px; border-bottom: 1px solid rgba(255,255,255,0.07); flex-shrink: 0;
}
.settings-header h3 { font-family: 'Fraunces', serif; font-size: 17px; font-weight: 400; }
.close-settings-btn {
  width: 28px; height: 28px; border-radius: 7px;
  background: rgba(255,255,255,0.07); border: 1px solid rgba(255,255,255,0.1);
  color: var(--muted); cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: all 0.15s; font-size: 16px; line-height: 1;
}
.close-settings-btn:hover { background: rgba(255,255,255,0.12); color: var(--text); }

.settings-body { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 22px; }

.s-lbl { font-size: 10px; text-transform: uppercase; letter-spacing: 1.2px; color: var(--muted); margin-bottom: 9px; display: block; }
.s-inp {
  width: 100%; padding: 9px 12px; background: rgba(255,255,255,0.07);
  border: 1px solid rgba(255,255,255,0.1); border-radius: 9px;
  color: var(--text); font-family: 'Figtree', sans-serif; font-size: 13px; outline: none;
}
.s-inp option { background: #2c1f2e; }
.s-row { display: flex; gap: 8px; }
.s-btn {
  padding: 9px 14px; border-radius: 9px;
  background: rgba(200,150,255,0.18); border: 1px solid rgba(200,150,255,0.28);
  color: #e0c8ff; font-size: 12px; cursor: pointer; font-family: 'Figtree', sans-serif;
  transition: all 0.15s; white-space: nowrap;
}
.s-btn:hover { background: rgba(200,150,255,0.28); }
.theme-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; }
.t-sw { aspect-ratio: 1; border-radius: 9px; cursor: pointer; border: 2px solid transparent; transition: all 0.15s; }
.t-sw.active { border-color: rgba(255,255,255,0.8); transform: scale(1.1); }

/* export/import buttons */
.io-row { display: flex; gap: 8px; }
.io-btn {
  flex: 1; padding: 9px 10px; border-radius: 9px; text-align: center;
  font-size: 12px; cursor: pointer; font-family: 'Figtree', sans-serif;
  transition: all 0.15s; border: 1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.06); color: var(--text);
  display: flex; align-items: center; justify-content: center; gap: 5px;
}
.io-btn:hover { background: rgba(255,255,255,0.12); }
.io-btn.export { border-color: rgba(100,220,150,0.3); color: #a0f0c0; }
.io-btn.export:hover { background: rgba(100,220,150,0.1); }
.io-btn.import { border-color: rgba(100,180,255,0.3); color: #a0c8ff; }
.io-btn.import:hover { background: rgba(100,180,255,0.1); }

.settings-footer { padding: 16px 20px; border-top: 1px solid rgba(255,255,255,0.06); font-size: 11px; color: var(--muted); line-height: 1.7; text-align: center; flex-shrink: 0; }

/* ‚îÄ‚îÄ EDIT BANNER ‚îÄ‚îÄ */
.edit-banner {
  position: fixed; bottom: 22px; left: 50%; transform: translateX(-50%);
  background: rgba(200,150,255,0.18); border: 1px solid rgba(200,150,255,0.28);
  backdrop-filter: blur(12px); border-radius: 40px;
  padding: 9px 20px; font-size: 12.5px; color: #e8d0ff;
  display: none; align-items: center; gap: 12px; z-index: 50; white-space: nowrap;
}
body.edit-mode .edit-banner { display: flex; }
.done-btn {
  background: rgba(200,150,255,0.28); border: 1px solid rgba(200,150,255,0.4);
  color: #f0e0ff; border-radius: 20px; padding: 3px 13px;
  font-size: 12px; cursor: pointer; font-family: 'Figtree', sans-serif;
}

/* ‚îÄ‚îÄ MODALS ‚îÄ‚îÄ */
.overlay {
  position: fixed; inset: 0; z-index: 200;
  background: rgba(0,0,0,0.5); backdrop-filter: blur(5px);
  display: none; align-items: center; justify-content: center;
}
.overlay.open { display: flex; }
.modal {
  background: #221430; border: 1px solid rgba(255,255,255,0.1);
  border-radius: 18px; padding: 26px; width: 380px; max-width: 95vw;
  animation: popIn 0.2s ease;
}
.modal h2 { font-family: 'Fraunces', serif; font-size: 18px; font-weight: 400; margin-bottom: 18px; }
.m-lbl { font-size: 10px; text-transform: uppercase; letter-spacing: 0.8px; color: var(--muted); margin-bottom: 5px; display: block; }
.m-inp {
  width: 100%; padding: 9px 13px; background: rgba(255,255,255,0.07);
  border: 1px solid rgba(255,255,255,0.1); border-radius: 9px; color: var(--text);
  font-family: 'Figtree', sans-serif; font-size: 13.5px; outline: none; margin-bottom: 13px;
  transition: border-color 0.2s;
}
.m-inp:focus { border-color: rgba(200,150,255,0.5); }
.emoji-row { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 14px; }
.e-opt {
  width: 34px; height: 34px; border-radius: 7px; font-size: 17px;
  display: flex; align-items: center; justify-content: center;
  border: 1px solid rgba(255,255,255,0.08); cursor: pointer;
  background: rgba(255,255,255,0.05); transition: all 0.15s;
}
.e-opt.sel { border-color: rgba(200,150,255,0.6); background: rgba(200,150,255,0.15); }
.modal-btns { display: flex; gap: 9px; }
.btn-p {
  flex: 1; padding: 10px; border-radius: 9px;
  background: rgba(200,150,255,0.22); border: 1px solid rgba(200,150,255,0.3);
  color: #f0e0ff; font-family: 'Figtree', sans-serif; font-size: 13.5px; font-weight: 600;
  cursor: pointer; transition: all 0.15s;
}
.btn-p:hover { background: rgba(200,150,255,0.32); }
.btn-c {
  flex: 1; padding: 10px; border-radius: 9px;
  background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1);
  color: var(--muted); font-family: 'Figtree', sans-serif; font-size: 13.5px;
  cursor: pointer; transition: all 0.15s;
}
.btn-c:hover { color: var(--text); }

/* toast notification */
.toast {
  position: fixed; bottom: 70px; left: 50%; transform: translateX(-50%) translateY(10px);
  background: rgba(40,25,50,0.95); border: 1px solid rgba(200,150,255,0.3);
  backdrop-filter: blur(12px); border-radius: 10px;
  padding: 10px 18px; font-size: 13px; color: var(--text);
  z-index: 300; opacity: 0; transition: all 0.3s ease; pointer-events: none;
}
.toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

@keyframes fadeUp { from { opacity:0; transform:translateY(14px); } to { opacity:1; transform:none; } }
@keyframes popIn { from { opacity:0; transform:scale(0.92); } to { opacity:1; transform:none; } }
</style>
</head>
<body>

<div class="bg-canvas"></div>
<div class="globe"></div>
<div class="grain"></div>

<div class="clock-display" id="clock"></div>

<div class="top-right">
  <button class="ctrl-btn" id="edit-btn" title="Edit Mode">
    <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
  </button>
  <button class="ctrl-btn" id="settings-btn" title="Settings">
    <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
  </button>
</div>

<div class="page">
  <div class="greeting" id="greeting">Welcome back</div>
  <div class="search-wrap">
    <div class="search-bar">
      <svg class="search-icon" width="17" height="17" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
      <input type="text" id="search-input" placeholder="Search the web..." />
      <div class="engine-pill" id="engine-pill">G</div>
    </div>
  </div>
  <div class="tabs" id="tab-bar"></div>
  <div class="app-grid" id="app-grid"></div>
</div>

<!-- SETTINGS PANEL -->
<div class="settings-panel" id="settings-panel">
  <div class="settings-header">
    <h3>‚öô Settings</h3>
    <button class="close-settings-btn" id="close-settings-btn" title="Close">‚úï</button>
  </div>
  <div class="settings-body">
    <div>
      <div class="s-lbl">Your Name</div>
      <div class="s-row">
        <input class="s-inp" id="name-inp" placeholder="Your name" style="flex:1" />
        <button class="s-btn" id="save-name">Save</button>
      </div>
    </div>
    <div>
      <div class="s-lbl">Search Engine</div>
      <select class="s-inp" id="engine-sel">
        <option value="https://google.com/search?q=">Google</option>
        <option value="https://duckduckgo.com/?q=">DuckDuckGo</option>
        <option value="https://search.brave.com/search?q=">Brave</option>
        <option value="https://bing.com/search?q=">Bing</option>
      </select>
    </div>
    <div>
      <div class="s-lbl">Theme</div>
      <div class="theme-grid">
        <div class="t-sw" data-theme="default" style="background:linear-gradient(135deg,#3a2540,#7a3a8a)"></div>
        <div class="t-sw" data-theme="midnight" style="background:linear-gradient(135deg,#0d0d2a,#2a2a7a)"></div>
        <div class="t-sw" data-theme="forest" style="background:linear-gradient(135deg,#0a1a0d,#2a7a3a)"></div>
        <div class="t-sw" data-theme="dusk" style="background:linear-gradient(135deg,#1a1010,#8a3030)"></div>
        <div class="t-sw" data-theme="ocean" style="background:linear-gradient(135deg,#05101a,#1a5a8a)"></div>
      </div>
    </div>
    <div>
      <div class="s-lbl">Bookmarks</div>
      <div class="io-row">
        <button class="io-btn export" id="export-btn">
          <svg width="13" height="13" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
          Export
        </button>
        <button class="io-btn import" id="import-btn">
          <svg width="13" height="13" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
          Import
        </button>
      </div>
      <input type="file" id="import-file-input" accept=".json" style="display:none" />
    </div>
  </div>
  <div class="settings-footer">
    Data stored locally in your browser.<br>
    Drag tabs &amp; apps to reorder. Right-click tabs to delete.
  </div>
</div>

<!-- EDIT BANNER -->
<div class="edit-banner">
  ‚úèÔ∏è Edit mode ‚Äî hover apps to remove, drag to reorder
  <button class="done-btn" id="done-btn">Done</button>
</div>

<!-- MODAL: Add App -->
<div class="overlay" id="app-overlay">
  <div class="modal">
    <h2>Add App</h2>
    <label class="m-lbl">Name</label>
    <input class="m-inp" id="app-name" placeholder="e.g. Figma" />
    <label class="m-lbl">URL</label>
    <input class="m-inp" id="app-url" placeholder="https://figma.com" />
    <label class="m-lbl">Icon</label>
    <div class="emoji-row" id="app-emojis"></div>
    <div class="modal-btns">
      <button class="btn-c" id="app-cancel">Cancel</button>
      <button class="btn-p" id="app-save">Add</button>
    </div>
  </div>
</div>

<!-- MODAL: Add Tab -->
<div class="overlay" id="tab-overlay">
  <div class="modal">
    <h2>New Tab</h2>
    <label class="m-lbl">Tab Name</label>
    <input class="m-inp" id="tab-name-inp" placeholder="e.g. Design" />
    <div class="modal-btns">
      <button class="btn-c" id="tab-cancel">Cancel</button>
      <button class="btn-p" id="tab-save">Create</button>
    </div>
  </div>
</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<script>
const EMOJIS = ['üåê','‚ñ∂Ô∏è','üìò','üê¶','üì∏','üéµ','üí¨','üõí','üì∞','üíº','üéÆ','üìß','üì∫','üåç','‚≠ê','üíª','üè†','üé®','üìä','‚òÅÔ∏è','üõ°Ô∏è','üì±','üöÄ','ü§ñ','üóÇÔ∏è','üîë','üß™','üì°','üé¨','üèãÔ∏è'];

const DEF = {
  name: 'Jonathan',
  activeTab: 'recent',
  theme: 'default',
  engine: 'https://google.com/search?q=',
  tabs: [
    {id:'recent', name:'Recently Used'},
    {id:'personal', name:'Personal'},
    {id:'work', name:'Work'},
  ],
  apps: {
    recent: [
      {id:'g',name:'Google',url:'https://google.com',icon:'üåê'},
      {id:'yt',name:'YouTube',url:'https://youtube.com',icon:'‚ñ∂Ô∏è'},
      {id:'gh',name:'GitHub',url:'https://github.com',icon:'üíª'},
      {id:'gm',name:'Gmail',url:'https://mail.google.com',icon:'üìß'},
      {id:'sl',name:'Slack',url:'https://slack.com',icon:'üí¨'},
      {id:'sp',name:'Spotify',url:'https://spotify.com',icon:'üéµ'},
      {id:'nt',name:'Notion',url:'https://notion.so',icon:'üóÇÔ∏è'},
      {id:'rd',name:'Reddit',url:'https://reddit.com',icon:'üåç'},
    ],
    personal: [
      {id:'ig',name:'Instagram',url:'https://instagram.com',icon:'üì∏'},
      {id:'tw',name:'Twitter',url:'https://twitter.com',icon:'üê¶'},
      {id:'nf',name:'Netflix',url:'https://netflix.com',icon:'üì∫'},
    ],
    work: [
      {id:'gh2',name:'GitHub',url:'https://github.com',icon:'üíª'},
      {id:'lk',name:'LinkedIn',url:'https://linkedin.com',icon:'üíº'},
      {id:'fig',name:'Figma',url:'https://figma.com',icon:'üé®'},
      {id:'gd',name:'Drive',url:'https://drive.google.com',icon:'‚òÅÔ∏è'},
    ]
  }
};

let S = (() => { try { return JSON.parse(localStorage.getItem('nt_v3') || 'null') || JSON.parse(JSON.stringify(DEF)); } catch(e) { return JSON.parse(JSON.stringify(DEF)); } })();
const save = () => localStorage.setItem('nt_v3', JSON.stringify(S));

// ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ
let toastTimer;
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg; t.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => t.classList.remove('show'), 2800);
}

// ‚îÄ‚îÄ CLOCK (12hr) ‚îÄ‚îÄ
function tick() {
  const n = new Date();
  let h = n.getHours(); const ampm = h >= 12 ? 'PM' : 'AM';
  h = h % 12 || 12;
  const m = n.getMinutes().toString().padStart(2,'0');
  document.getElementById('clock').textContent = `${h}:${m} ${ampm}`;
}
tick(); setInterval(tick, 10000);

// ‚îÄ‚îÄ GREETING ‚îÄ‚îÄ
function setGreeting() {
  const h = new Date().getHours();
  const g = h < 12 ? 'Good morning' : h < 17 ? 'Good afternoon' : 'Good evening';
  document.getElementById('greeting').textContent = `${g}, ${S.name}`;
}

// ‚îÄ‚îÄ THEME ‚îÄ‚îÄ
function applyTheme(t) {
  if (t === 'default') document.body.removeAttribute('data-theme');
  else document.body.setAttribute('data-theme', t);
  document.querySelectorAll('.t-sw').forEach(s => s.classList.toggle('active', s.dataset.theme === t));
}

// ‚îÄ‚îÄ ENGINE BADGE ‚îÄ‚îÄ
const ENGINE_BADGES = {'google':'G','duckduckgo':'D','brave':'B','bing':'‚í∑'};
function updateBadge() {
  const k = Object.keys(ENGINE_BADGES).find(k => S.engine.includes(k)) || 'google';
  document.getElementById('engine-pill').textContent = ENGINE_BADGES[k];
}

// ‚îÄ‚îÄ RENDER TABS (with drag-to-reorder) ‚îÄ‚îÄ
let dragTabId = null;

function renderTabs() {
  const bar = document.getElementById('tab-bar');
  bar.innerHTML = '';

  S.tabs.forEach(tab => {
    const btn = document.createElement('button');
    btn.className = 'tab' + (tab.id === S.activeTab ? ' active' : '');
    btn.textContent = tab.name;
    btn.draggable = true;
    btn.dataset.id = tab.id;

    // click to switch
    btn.onclick = () => {
      S.activeTab = tab.id;
      if (!S.apps[tab.id]) S.apps[tab.id] = [];
      save(); renderTabs(); renderApps();
    };

    // right-click to delete
    btn.oncontextmenu = e => {
      e.preventDefault();
      if (S.tabs.length <= 1) return;
      if (!confirm(`Delete "${tab.name}"?`)) return;
      S.tabs = S.tabs.filter(t => t.id !== tab.id);
      delete S.apps[tab.id];
      if (S.activeTab === tab.id) S.activeTab = S.tabs[0].id;
      save(); renderTabs(); renderApps();
    };

    // drag events for reordering
    btn.addEventListener('dragstart', e => {
      dragTabId = tab.id;
      btn.classList.add('dragging');
      e.dataTransfer.effectAllowed = 'move';
    });
    btn.addEventListener('dragend', () => {
      dragTabId = null;
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('dragging','drag-over'));
    });
    btn.addEventListener('dragover', e => {
      if (!dragTabId || dragTabId === tab.id) return;
      e.preventDefault(); e.dataTransfer.dropEffect = 'move';
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('drag-over'));
      btn.classList.add('drag-over');
    });
    btn.addEventListener('dragleave', () => btn.classList.remove('drag-over'));
    btn.addEventListener('drop', e => {
      e.preventDefault();
      if (!dragTabId || dragTabId === tab.id) return;
      const fromIdx = S.tabs.findIndex(t => t.id === dragTabId);
      const toIdx = S.tabs.findIndex(t => t.id === tab.id);
      const [moved] = S.tabs.splice(fromIdx, 1);
      S.tabs.splice(toIdx, 0, moved);
      save(); renderTabs();
    });

    bar.appendChild(btn);
  });

  const addBtn = document.createElement('button');
  addBtn.className = 'tab-add-btn'; addBtn.textContent = '+';
  addBtn.onclick = () => openTabModal();
  bar.appendChild(addBtn);
}

// ‚îÄ‚îÄ RENDER APPS (with drag-to-reorder) ‚îÄ‚îÄ
let dragAppId = null;

function renderApps() {
  const grid = document.getElementById('app-grid');
  grid.innerHTML = '';
  const apps = S.apps[S.activeTab] || [];

  apps.forEach((app, i) => {
    const card = document.createElement('a');
    card.className = 'app-card'; card.href = app.url;
    card.draggable = true;
    card.dataset.id = app.id;
    card.style.animationDelay = `${i * 30}ms`;
    card.innerHTML = `<div class="app-icon">${app.icon}</div><div class="app-name">${app.name}</div>`;

    // click/edit-mode delete
    card.addEventListener('click', e => {
      if (document.body.classList.contains('edit-mode')) {
        e.preventDefault();
        S.apps[S.activeTab] = (S.apps[S.activeTab] || []).filter(a => a.id !== app.id);
        save(); renderTabs(); renderApps();
      }
    });

    // drag reorder
    card.addEventListener('dragstart', e => {
      dragAppId = app.id;
      setTimeout(() => card.classList.add('dragging'), 0);
      e.dataTransfer.effectAllowed = 'move';
    });
    card.addEventListener('dragend', () => {
      dragAppId = null;
      document.querySelectorAll('.app-card').forEach(c => c.classList.remove('dragging','drag-over-card'));
    });
    card.addEventListener('dragover', e => {
      if (!dragAppId || dragAppId === app.id) return;
      e.preventDefault();
      document.querySelectorAll('.app-card').forEach(c => c.classList.remove('drag-over-card'));
      card.classList.add('drag-over-card');
    });
    card.addEventListener('dragleave', () => card.classList.remove('drag-over-card'));
    card.addEventListener('drop', e => {
      e.preventDefault();
      if (!dragAppId || dragAppId === app.id) return;
      const list = S.apps[S.activeTab];
      const fromIdx = list.findIndex(a => a.id === dragAppId);
      const toIdx = list.findIndex(a => a.id === app.id);
      const [moved] = list.splice(fromIdx, 1);
      list.splice(toIdx, 0, moved);
      save(); renderApps();
    });

    grid.appendChild(card);
  });

  const addCard = document.createElement('div');
  addCard.className = 'app-card add-app-card';
  addCard.innerHTML = `<div class="app-icon">+</div><div class="app-name">Add</div>`;
  addCard.onclick = () => openAppModal();
  grid.appendChild(addCard);
}

// ‚îÄ‚îÄ SEARCH ‚îÄ‚îÄ
document.getElementById('search-input').addEventListener('keydown', e => {
  if (e.key !== 'Enter') return;
  const q = e.target.value.trim(); if (!q) return;
  const isURL = /^https?:\/\//.test(q) || (/\.[a-z]{2,}/.test(q) && !q.includes(' '));
  window.location.href = isURL ? (q.startsWith('http') ? q : 'https://'+q) : S.engine + encodeURIComponent(q);
});

// ‚îÄ‚îÄ SETTINGS OPEN / CLOSE ‚îÄ‚îÄ
document.getElementById('settings-btn').onclick = () => document.getElementById('settings-panel').classList.add('open');
document.getElementById('close-settings-btn').onclick = () => document.getElementById('settings-panel').classList.remove('open');

document.querySelectorAll('.t-sw').forEach(s => s.onclick = () => { S.theme = s.dataset.theme; save(); applyTheme(S.theme); });
document.getElementById('engine-sel').onchange = e => { S.engine = e.target.value; save(); updateBadge(); };
document.getElementById('save-name').onclick = () => {
  const v = document.getElementById('name-inp').value.trim();
  if (v) { S.name = v; save(); setGreeting(); showToast('‚úì Name saved'); }
};

// ‚îÄ‚îÄ EXPORT ‚îÄ‚îÄ
document.getElementById('export-btn').onclick = () => {
  const data = { tabs: S.tabs, apps: S.apps, exportedAt: new Date().toISOString() };
  const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'newtab-bookmarks.json'; a.click();
  URL.revokeObjectURL(url);
  showToast('‚úì Bookmarks exported');
};

// ‚îÄ‚îÄ IMPORT ‚îÄ‚îÄ
document.getElementById('import-btn').onclick = () => document.getElementById('import-file-input').click();
document.getElementById('import-file-input').onchange = e => {
  const file = e.target.files[0]; if (!file) return;
  const reader = new FileReader();
  reader.onload = ev => {
    try {
      const data = JSON.parse(ev.target.result);
      if (!data.tabs || !data.apps) throw new Error('Invalid format');
      if (!confirm(`Import ${data.tabs.length} tab(s)? This will REPLACE your current tabs and apps.`)) return;
      S.tabs = data.tabs;
      S.apps = data.apps;
      S.activeTab = data.tabs[0]?.id || S.activeTab;
      save(); renderTabs(); renderApps();
      showToast('‚úì Bookmarks imported successfully');
    } catch(err) {
      showToast('‚úó Invalid file ‚Äî import failed');
    }
  };
  reader.readAsText(file);
  e.target.value = ''; // reset so same file can be re-imported
};

// ‚îÄ‚îÄ EDIT MODE ‚îÄ‚îÄ
document.getElementById('edit-btn').onclick = () => {
  document.body.classList.toggle('edit-mode');
  document.getElementById('edit-btn').classList.toggle('active');
};
document.getElementById('done-btn').onclick = () => {
  document.body.classList.remove('edit-mode');
  document.getElementById('edit-btn').classList.remove('active');
};

// ‚îÄ‚îÄ APP MODAL ‚îÄ‚îÄ
let selEmoji = 'üåê';
function buildEmojis() {
  const row = document.getElementById('app-emojis'); row.innerHTML = '';
  EMOJIS.forEach(em => {
    const el = document.createElement('div');
    el.className = 'e-opt' + (em === selEmoji ? ' sel' : '');
    el.textContent = em;
    el.onclick = () => { selEmoji = em; row.querySelectorAll('.e-opt').forEach(x=>x.classList.remove('sel')); el.classList.add('sel'); };
    row.appendChild(el);
  });
}
function openAppModal() {
  selEmoji = 'üåê';
  document.getElementById('app-name').value = '';
  document.getElementById('app-url').value = '';
  buildEmojis();
  document.getElementById('app-overlay').classList.add('open');
  setTimeout(() => document.getElementById('app-name').focus(), 80);
}
document.getElementById('app-cancel').onclick = () => document.getElementById('app-overlay').classList.remove('open');
document.getElementById('app-overlay').onclick = e => { if(e.target===e.currentTarget) e.currentTarget.classList.remove('open'); };
document.getElementById('app-save').onclick = () => {
  const name = document.getElementById('app-name').value.trim();
  let url = document.getElementById('app-url').value.trim();
  if (!name || !url) return showToast('‚úó Fill in all fields');
  if (!url.startsWith('http')) url = 'https://' + url;
  if (!S.apps[S.activeTab]) S.apps[S.activeTab] = [];
  S.apps[S.activeTab].push({id: Date.now()+'', name, url, icon: selEmoji});
  save(); renderTabs(); renderApps();
  document.getElementById('app-overlay').classList.remove('open');
  showToast(`‚úì ${name} added`);
};

// ‚îÄ‚îÄ TAB MODAL ‚îÄ‚îÄ
function openTabModal() {
  document.getElementById('tab-name-inp').value = '';
  document.getElementById('tab-overlay').classList.add('open');
  setTimeout(() => document.getElementById('tab-name-inp').focus(), 80);
}
document.getElementById('tab-cancel').onclick = () => document.getElementById('tab-overlay').classList.remove('open');
document.getElementById('tab-overlay').onclick = e => { if(e.target===e.currentTarget) e.currentTarget.classList.remove('open'); };
document.getElementById('tab-save').onclick = () => {
  const name = document.getElementById('tab-name-inp').value.trim(); if (!name) return;
  const id = 'tab' + Date.now();
  S.tabs.push({id, name}); S.apps[id] = []; S.activeTab = id;
  save(); renderTabs(); renderApps();
  document.getElementById('tab-overlay').classList.remove('open');
};

// ‚îÄ‚îÄ INIT ‚îÄ‚îÄ
document.getElementById('name-inp').value = S.name;
document.getElementById('engine-sel').value = S.engine;
applyTheme(S.theme); updateBadge(); setGreeting(); renderTabs(); renderApps();
</script>
</body>
</html>
